import{a as H}from"./chunk-6HV44JDT.js";import{g as S}from"./chunk-CLVL2V3E.js";import{J as x,Mb as g,O as a,U as s,i as C,oa as r}from"./chunk-V72BES3P.js";var d=class i{selectedSong=r({});static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var f=class i{selectedSong=r({});static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var u=class i{selectedListSongs=r([]);static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var m=class i{selectedGender=r({});static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var v=class i{dataPlayList=r({});toogleFormulary=r(!1);toogleAddSong=r(!1);static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var b=class i{selectedArtist=r({});static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var h=class i{listDataSongs=r([]);listSongsFiltered=r([]);setListDataSongs(e){this.listDataSongs.set(e),this.listSongsFiltered.set(e)}changeFilteredSongs(e){if(e.value.trim()==="")return this.resetFilter(),this.listSongsFiltered();switch(e.type){case"CATEGORY":{this.filteredByCategory(e.value);break}case"SEARCH":{this.filteredBySearch(e.value);break}case"ARTIST":this.filteredByArtist(e.value)}return this.listSongsFiltered()}filteredByArtist(e){this.listSongsFiltered.set(this.listDataSongs().filter(t=>t.artist.toLowerCase()===e.toLowerCase()))}filteredByCategory(e){this.listSongsFiltered.set(this.listDataSongs().filter(t=>t.gender.toLowerCase()===e.toLowerCase()))}filteredBySearch(e){this.listSongsFiltered.set(this.listDataSongs().filter(t=>t.name.toLowerCase().includes(e.toLowerCase())))}resetFilter(){this.listSongsFiltered.set(this.listDataSongs())}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var y=class i{dataSearch=r({type:"SEARCH",value:"ALL"});activationSong=r(!0);activationGender=r(!1);activationSinger=r(!1);setStateElements(e){e==="ARTIST"?(this.activationSong.set(!1),this.activationGender.set(!1),this.dataSearch.set({type:"ARTIST",value:"ALL"})):e==="CATEGORY"?(this.activationSong.set(!1),this.activationSinger.set(!1),this.dataSearch.set({type:"CATEGORY",value:"ALL"})):(this.activationSinger.set(!1),this.activationGender.set(!1),this.dataSearch.set({type:"SEARCH",value:"ALL"}))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var L=class i{constructor(){}setMediaSessionMetadata(e,t,o,c=[]){"mediaSession"in navigator&&(navigator.mediaSession.metadata=new MediaMetadata({title:e,artist:t,album:o,artwork:c.map(l=>({src:l,sizes:"512x512"}))}))}playBackState(){"mediaSession"in navigator&&(navigator.mediaSession.playbackState="playing")}stopBackState(){"mediaSession"in navigator&&(navigator.mediaSession.playbackState="paused")}setMediaSessionHandlers(e,t,o,c){"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",e),navigator.mediaSession.setActionHandler("pause",t),navigator.mediaSession.setActionHandler("nexttrack",o),navigator.mediaSession.setActionHandler("previoustrack",c))}clearMediaSessionHandlers(){"mediaSession"in navigator&&(navigator.mediaSession.setActionHandler("play",null),navigator.mediaSession.setActionHandler("pause",null),navigator.mediaSession.setActionHandler("nexttrack",null),navigator.mediaSession.setActionHandler("previoustrack",null))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var A=class i{activateMenuMobile=r(!1);activateMenu=r(!1);selectedSong=r({});listSongs=r([]);currentTypePlay=r("shuffle");devicesConfigService=s(L);audioRef=r({});autoPlaySongState=r(!1);playAudio(){this.audioRef().nativeElement.play(),this.selectedSong().isPlaying=!0,this.autoPlaySongState.set(!0),this.devicesConfigService.playBackState()}setSongSelected(e){this.selectedSong().isPlaying=!1,this.selectedSong.set(e),this.selectedSong().isPlaying=!0,this.updateMediaSessionMetadata()}changeSongNext(){if(this.listSongs().length<=1){this.selectedSong().isPlaying=!0,this.updateMediaSessionMetadata();return}let e=this.currentTypePlay(),t=this.listSongs().indexOf(this.selectedSong()),o=0,c=this.selectedSong();switch(c&&(c.isPlaying=!1),e){case"shuffle":let l=0;do l=Math.floor(Math.random()*this.listSongs().length);while(l===t);o=l;break;case"repeat":t<this.listSongs().length-1?o=t+1:o=0;break;default:t<this.listSongs().length-1?o=t+1:o=0;break}this.selectedSong.set(this.listSongs()[o]),this.selectedSong().isPlaying=!0,this.updateMediaSessionMetadata()}changeSongBack(){if(this.listSongs().length<=1){this.selectedSong().isPlaying=!0,this.updateMediaSessionMetadata();return}let e=this.currentTypePlay(),t=this.listSongs().indexOf(this.selectedSong()),o,c=this.selectedSong();switch(c&&(c.isPlaying=!1),e){case"shuffle":let l=0;do l=Math.floor(Math.random()*this.listSongs().length);while(l===t);o=l;break;case"repeat":t===0?o=this.listSongs().length-1:o=t-1;break;default:t===0?o=this.listSongs().length-1:o=t-1;break}this.selectedSong.set(this.listSongs()[o]),this.selectedSong().isPlaying=!0,this.updateMediaSessionMetadata()}stopAudio(){this.audioRef().nativeElement.pause(),this.autoPlaySongState.set(!1),this.devicesConfigService.stopBackState()}changeFavoriteSong(){this.selectedSong().isFavorite=!this.selectedSong().isFavorite}changeFavoriteSonSelected(e){e.isFavorite=!e.isFavorite}setupMediaSessionHandlers(e,t,o,c){this.devicesConfigService.setMediaSessionHandlers(()=>e(),()=>t(),()=>o(),()=>c())}updateMediaSessionMetadata(){let e=this.selectedSong();if(e&&e.name&&e.artist){let t=e.image?[e.image]:[];this.devicesConfigService.setMediaSessionMetadata(e.name,e.artist,e.album,t)}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var I=class i{urlApi="data/music_data_songs.json";httpClient=s(S);getAll(){return this.httpClient.get(this.urlApi)}getSongNew(){return this.httpClient.get("data/music_data_new.json")}getSongMostListened(){return this.httpClient.get("data/music_data_new.json")}getAllHistory(){return this.httpClient.get(this.urlApi)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var M=class i{urlApi="data/music_data_songs.json";httpClient=s(S);getAllGender(){return this.httpClient.get("data/music_data_gender_all.json")}getGenderMostListened(){return this.httpClient.get("data/music_data_gender.json")}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var j=class i{urlApi="data/music_data_songs.json";httpClient=s(S);getArtist(){return this.httpClient.get("data/music_data_artist.json")}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var P=class i{urlApi="data/music_data_songs.json";httpClient=s(S);getDataPlayList(){return this.httpClient.get("data/music_data_play_list.json")}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var F=class i{urlApi="data/music_list-songs.json";httpClient=s(S);getAll(){return this.httpClient.get(this.urlApi)}createNewListSongs(e){return this.httpClient.post(this.urlApi,e)}deleteSongOfList(e,t){this.httpClient.delete(this.urlApi+"/"+e+"/"+t)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var w=class i{apisSongs=s(I);apisGender=s(M);apisArtist=s(j);apisPlayList=s(P);apisListSongs=s(F);static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var p=class i{musicService=s(w);songMostListened=this.createSignalWithRefresh(()=>this.musicService.apisSongs.getSongMostListened(),{});newSong=this.createSignalWithRefresh(()=>this.musicService.apisSongs.getSongNew(),{});songsHistory=this.createSignalWithRefresh(()=>this.musicService.apisSongs.getAllHistory(),[]);getGenderMostListened=this.createSignalWithRefresh(()=>this.musicService.apisGender.getGenderMostListened(),{});getDataPlayList=this.createSignalWithRefresh(()=>this.musicService.apisPlayList.getDataPlayList(),{});getArtirstMostListened=this.createSignalWithRefresh(()=>this.musicService.apisArtist.getArtist(),{});allSongs=this.createSignalWithRefresh(()=>this.musicService.apisSongs.getAll(),[]);getAllListSongs=this.createSignalWithRefresh(()=>this.musicService.apisListSongs.getAll(),[]);createNewListSongs(e){return this.musicService.apisListSongs.createNewListSongs(e)}deleteSongOfList(e,t){this.musicService.apisListSongs.deleteSongOfList(e,t)}createSignalWithRefresh(e,t){let o=new C,c=H(o.pipe(x(()=>e())),{initialValue:t}),l=()=>o.next();return l(),{signal:c,refresh:l}}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var T=class i{musicDataService=s(p);createNewListSongs(e){this.musicDataService.createNewListSongs(e).subscribe({next:()=>{this.musicDataService.getAllListSongs.refresh()},error:t=>{alert("Error al crear una lista de cancione nueva")}})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var R=class i{musicDataService=s(p);activateSection=r(!1);listsListSongs=r([]);listSongsSelected=r({});deleteSongOfList(e,t){this.musicDataService.deleteSongOfList(e.id,t)}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var W=class i{listAllSongs=r([]);listAllSongsFiltered=r(this.listAllSongs());listSongsSelected=r([]);isSongSelected(e){return this.listSongsSelected().some(t=>t.id===e.id)}deleteSongSelected(e){this.listSongsSelected.update(t=>t.filter(o=>o.id!==e.id)),console.log("el listado de canciones seleccionadas 2: ",this.listSongsSelected())}addSongToList(e){this.listSongsSelected.update(t=>[...t,e]),console.log("el listado de canciones seleccionadas 1: ",this.listSongsSelected())}filteredSongsByName(e){this.listAllSongsFiltered.set(this.listAllSongs().filter(t=>t.name.toLowerCase().includes(e.toLowerCase())))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};var k=class i{musicDataService=s(p);stateSectionNewsService=s(d);stateSectionNewMusicService=s(f);stateSectionOtherService=s(u);stateSectionTrendsService=s(m);stateSectionPlayListService=s(v);stateSectionArtistsService=s(b);stateSectionMainMusicService=s(h);stateSectionSearchService=s(y);stateMusicPlayerService=s(A);stateFormularyCreateListService=s(T);stateMyListSongsService=s(R);stateSectionAddSongToListService=s(W);constructor(){g(()=>{this.stateSectionNewsService.selectedSong.set(this.musicDataService.songMostListened.signal())}),g(()=>{this.stateSectionNewMusicService.selectedSong.set(this.musicDataService.newSong.signal())}),g(()=>{this.stateSectionOtherService.selectedListSongs.set(this.musicDataService.songsHistory.signal())}),g(()=>{this.stateSectionTrendsService.selectedGender.set(this.musicDataService.getGenderMostListened.signal())}),g(()=>{this.stateSectionPlayListService.dataPlayList.set(this.musicDataService.getDataPlayList.signal())}),g(()=>{this.stateSectionArtistsService.selectedArtist.set(this.musicDataService.getArtirstMostListened.signal())}),g(()=>{this.stateSectionMainMusicService.setListDataSongs(this.musicDataService.allSongs.signal()),this.stateSectionAddSongToListService.listAllSongs.set(this.musicDataService.allSongs.signal()),this.stateSectionAddSongToListService.listAllSongsFiltered.set(this.musicDataService.allSongs.signal())}),g(()=>{this.stateMyListSongsService.listsListSongs.set(this.musicDataService.getAllListSongs.signal())})}static \u0275fac=function(t){return new(t||i)};static \u0275prov=a({token:i,factory:i.\u0275fac,providedIn:"root"})};export{k as a};
